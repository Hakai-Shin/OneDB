LOAD EMPLOYEE
S1 <- PROJECT Ssn,Super_ssn,Dno FROM EMPLOYEE
S2 <- CROSS S1 S1
S3 <- SELECT S11_Super_ssn == S12_Ssn FROM S2
S4 <- SELECT S11_Dno != S12_Dno FROM S3
RENAME S11_Ssn TO Ssn FROM S4
RENAME S11_Dno TO Dno FROM S4
RENAME S11_Super_ssn TO Super_ssn FROM S4
RENAME S12_Dno TO Super_dno FROM S4
Q1 <- PROJECT Ssn,Dno,Super_ssn,Super_dno FROM S4
LOAD WORKS_ON
LOAD PROJECT
LOAD EMPLOYEE
A <- CROSS EMPLOYEE WORKS_ON
B <- SELECT Ssn == Essn FROM A
C <- CROSS B PROJECT
D <- SELECT Dno == Dnum FROM C
E <- SELECT Pno == Pnumber FROM D
RENAME Dnum TO P_dno FROM E
Q2 <- PROJECT Ssn,Dno,Pno,P_dno FROM E
LOAD WORKS_ON
LOAD PROJECT
LOAD EMPLOYEE
1 <- CROSS EMPLOYEE WORKS_ON
2 <- SELECT Ssn == Essn FROM 1
3 <- CROSS 2 PROJECT
4 <- SELECT Dno != Dnum FROM 3
5 <- SELECT Pno == Pnumber FROM 4
RENAME Dnum TO P_dno FROM 5
Q3 <- PROJECT Ssn,Dno,Pno,P_dno FROM 5
LOAD EMPLOYEE
M <- PROJECT Ssn,Bdate,Super_ssn FROM EMPLOYEE
N <- CROSS M M
O <- SELECT M1_Super_ssn == M2_Ssn FROM N
P <- SELECT M1_Bdate < M2_Bdate FROM O
RENAME M1_Ssn TO Essn FROM P
RENAME M2_Ssn TO Super_Ssn FROM P
RENAME M1_Bdate TO E_bdate FROM P
RENAME M2_Bdate TO Super_bdate FROM P
Q4 <- PROJECT Super_Ssn,Super_bdate,Essn,E_bdate FROM P
LOAD EMPLOYEE
R <- PROJECT Ssn,Sex,Dno FROM EMPLOYEE
S <- CROSS R R
T <- SELECT R1_Sex != R2_Sex FROM S
U <- SELECT R1_Dno == R2_Dno FROM T
RENAME R1_Dno TO Dno FROM U
Q5 <- PROJECT Dno FROM U
EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT
